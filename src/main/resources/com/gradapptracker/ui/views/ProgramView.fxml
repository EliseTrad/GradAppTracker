<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<!--
  ProgramView.fxml
  Full CRUD management for graduate programs.
  Shows all program fields except IDs.
-->
<ScrollPane xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.gradapptracker.ui.controllers.ProgramController" stylesheets="@/styles/styles.css" fitToWidth="true" prefViewportHeight="700" style="-fx-background-color: #f8f9fa; -fx-background: #f8f9fa;">
  <content>
    <VBox spacing="20" style="-fx-background-color: #f8f9fa;">

      <children>
        <!-- Page Title -->
        <Label text="Dashboard" styleClass="section-title" style="-fx-font-size: 24px;" />

        <!-- Programs Table Section -->
        <VBox styleClass="content-card" spacing="15" VBox.vgrow="ALWAYS">
          <HBox alignment="CENTER_LEFT" spacing="12">
            <Label text="All Programs" styleClass="section-title" />
            <Region HBox.hgrow="ALWAYS" />

            <!-- Enhanced Filtering Section -->
            <VBox spacing="8">
              <Label text="Filter Programs:" style="-fx-font-weight: bold;" />
              <FlowPane hgap="8" vgap="8" alignment="CENTER_LEFT">
                <VBox spacing="4">
                  <Label text="University:" style="-fx-font-size: 11px;" />
                  <TextField fx:id="txtFilterUniversity" promptText="University..." prefWidth="110" />
                </VBox>
                <VBox spacing="4">
                  <Label text="Field of Study:" style="-fx-font-size: 11px;" />
                  <TextField fx:id="txtFilterFieldOfStudy" promptText="Field..." prefWidth="110" />
                </VBox>
                <VBox spacing="4">
                  <Label text="Status:" style="-fx-font-size: 11px;" />
                  <TextField fx:id="txtFilterStatus" promptText="Status..." prefWidth="90" />
                </VBox>
                <VBox spacing="4">
                  <Label text="Focus Area:" style="-fx-font-size: 11px;" />
                  <TextField fx:id="txtFilterFocusArea" promptText="Focus..." prefWidth="90" />
                </VBox>
                <VBox spacing="4">
                  <Label text="Tuition:" style="-fx-font-size: 11px;" />
                  <TextField fx:id="txtFilterTuition" promptText="Tuition..." prefWidth="90" />
                </VBox>
                <VBox spacing="4">
                  <Label text="Portal:" style="-fx-font-size: 11px;" />
                  <TextField fx:id="txtFilterPortal" promptText="Portal..." prefWidth="90" />
                </VBox>
                <VBox spacing="4">
                  <Label text="Website:" style="-fx-font-size: 11px;" />
                  <TextField fx:id="txtFilterWebsite" promptText="Website..." prefWidth="90" />
                </VBox>
                <VBox spacing="4" alignment="BOTTOM_LEFT">
                  <Label text=" " style="-fx-font-size: 11px;" />
                  <HBox spacing="6">
                    <Button text="Filter" fx:id="btnFilter" onAction="#onFilter" prefWidth="80" />
                    <Button text="Clear" fx:id="btnClearFilter" onAction="#onClearFilter" styleClass="button-outline" prefWidth="60" />
                  </HBox>
                </VBox>
              </FlowPane>
            </VBox>
            <Button text="Refresh" fx:id="btnRefresh" onAction="#onRefresh" styleClass="button-secondary" prefWidth="80" />
          </HBox>

          <!-- Programs Table -->
          <TableView fx:id="tblPrograms" VBox.vgrow="ALWAYS" onMouseClicked="#onRowSelect">
            <columns>
              <TableColumn text="University Name" fx:id="colUniversityName" prefWidth="180" style="-fx-alignment: CENTER;" />
              <TableColumn text="Field of Study" fx:id="colFieldOfStudy" prefWidth="140" style="-fx-alignment: CENTER;" />
              <TableColumn text="Focus Area" fx:id="colFocusArea" prefWidth="130" style="-fx-alignment: CENTER;" />
              <TableColumn text="Deadline" fx:id="colDeadline" prefWidth="100" style="-fx-alignment: CENTER;" />
              <TableColumn text="Status" fx:id="colStatus" prefWidth="100" style="-fx-alignment: CENTER;" />
              <TableColumn text="Tuition" fx:id="colTuition" prefWidth="120" style="-fx-alignment: CENTER;" />
              <TableColumn text="Portal" fx:id="colPortal" prefWidth="150" style="-fx-alignment: CENTER;" />
              <TableColumn text="Website" fx:id="colWebsite" prefWidth="150" style="-fx-alignment: CENTER;" />
            </columns>
            <placeholder>
              <Label text="No programs found. Add your first program below!" style="-fx-text-fill: #9e9e9e; -fx-font-size: 14px;" />
            </placeholder>
          </TableView>

          <Label fx:id="lblProgramCount" text="Total: 0 programs" style="-fx-text-fill: #757575;" />

          <!-- Add Program Button -->
          <HBox alignment="CENTER_LEFT" spacing="12">
            <Button text="Add New Program" fx:id="btnShowAddForm" onAction="#onShowAddForm" styleClass="button-success" prefWidth="180" />
            <Region HBox.hgrow="ALWAYS" />
          </HBox>
        </VBox>

        <!-- Program Details Form -->
        <VBox fx:id="programFormSection" styleClass="content-card" spacing="15" visible="true" managed="true">
          <HBox alignment="CENTER_LEFT" spacing="12">
            <Label text="Program Details" styleClass="section-title" />
            <Region HBox.hgrow="ALWAYS" />
            <Label fx:id="lblFormMode" text="Select a program to view details" style="-fx-font-weight: bold; -fx-text-fill: #7b1fa2;" />
          </HBox>

          <!-- Form Fields -->
          <GridPane hgap="15" vgap="15">
            <columnConstraints>
              <ColumnConstraints halignment="RIGHT" minWidth="140" prefWidth="140" />
              <ColumnConstraints hgrow="ALWAYS" />
            </columnConstraints>

            <!-- Row 0: University Name -->
            <Label text="University Name:" styleClass="field-label" GridPane.rowIndex="0" GridPane.columnIndex="0" />
            <TextField fx:id="txtUniversityName" promptText="e.g., Stanford University" GridPane.rowIndex="0" GridPane.columnIndex="1" />

            <!-- Row 1: Field of Study -->
            <Label text="Field of Study:" styleClass="field-label" GridPane.rowIndex="1" GridPane.columnIndex="0" />
            <TextField fx:id="txtFieldOfStudy" promptText="e.g., Computer Science" GridPane.rowIndex="1" GridPane.columnIndex="1" />

            <!-- Row 2: Focus Area -->
            <Label text="Focus Area:" styleClass="field-label" GridPane.rowIndex="2" GridPane.columnIndex="0" />
            <TextField fx:id="txtFocusArea" promptText="e.g., Machine Learning, AI" GridPane.rowIndex="2" GridPane.columnIndex="1" />

            <!-- Row 3: Portal -->
            <Label text="Application Portal:" styleClass="field-label" GridPane.rowIndex="3" GridPane.columnIndex="0" />
            <TextField fx:id="txtPortal" promptText="e.g., ApplyWeb, Slate" GridPane.rowIndex="3" GridPane.columnIndex="1" />

            <!-- Row 4: Website -->
            <Label text="Program Website:" styleClass="field-label" GridPane.rowIndex="4" GridPane.columnIndex="0" />
            <TextField fx:id="txtWebsite" promptText="https://..." GridPane.rowIndex="4" GridPane.columnIndex="1" />

            <!-- Row 5: Deadline -->
            <Label text="Deadline:" styleClass="field-label" GridPane.rowIndex="5" GridPane.columnIndex="0" />
            <DatePicker fx:id="dpDeadline" promptText="Select date" GridPane.rowIndex="5" GridPane.columnIndex="1" prefWidth="200" />

            <!-- Row 6: Status (free text field) -->
            <Label text="Status:" styleClass="field-label" GridPane.rowIndex="6" GridPane.columnIndex="0" />
            <TextField fx:id="txtStatus" promptText="e.g., Pending, Submitted, etc." GridPane.rowIndex="6" GridPane.columnIndex="1" />

            <!-- Row 7: Tuition -->
            <Label text="Tuition Info:" styleClass="field-label" GridPane.rowIndex="7" GridPane.columnIndex="0" />
            <TextField fx:id="txtTuition" promptText="e.g., Full scholarship, $50,000/year" GridPane.rowIndex="7" GridPane.columnIndex="1" />

            <!-- Row 8: Requirements -->
            <Label text="Requirements:" styleClass="field-label" GridPane.rowIndex="8" GridPane.columnIndex="0" />
            <TextArea fx:id="txtRequirements" promptText="List required documents, tests, etc." prefRowCount="3" wrapText="true" GridPane.rowIndex="8" GridPane.columnIndex="1" />

            <!-- Row 9: Notes -->
            <Label text="Notes:" styleClass="field-label" GridPane.rowIndex="9" GridPane.columnIndex="0" />
            <TextArea fx:id="txtNotes" promptText="Additional notes about this program..." prefRowCount="3" wrapText="true" GridPane.rowIndex="9" GridPane.columnIndex="1" />
          </GridPane>

          <!-- Action Buttons -->
          <HBox spacing="12" alignment="CENTER_LEFT">
            <Button text="Add Program" fx:id="btnAdd" onAction="#onAdd" styleClass="button-success" prefWidth="150" />
            <Button text="Save Changes" fx:id="btnEdit" onAction="#onEdit" styleClass="button-primary" prefWidth="150" />
            <Button text="Delete" fx:id="btnDelete" onAction="#onDelete" styleClass="button-danger" prefWidth="100" />
            <Button text="Clear Form" fx:id="btnClear" onAction="#onClear" styleClass="button-outline" prefWidth="120" />
            <Region HBox.hgrow="ALWAYS" />
            <Button text="Manage Linked Documents" fx:id="btnManageDocuments" onAction="#onManageDocuments" styleClass="button-secondary" prefWidth="220" />
          </HBox>
        </VBox>

        <!-- Linked Documents Section -->
        <VBox fx:id="linkedDocsSection" styleClass="content-card" spacing="15" visible="true" managed="true">
          <Label text="Linked Documents for Selected Program" styleClass="section-title" />

          <HBox spacing="12" alignment="CENTER_LEFT">
            <ComboBox fx:id="cbAvailableDocuments" promptText="Select document to link" prefWidth="300" />
            <TextField fx:id="txtUsageNotes" promptText="Usage notes (optional)" HBox.hgrow="ALWAYS" />
            <Button text="Link Document" fx:id="btnLinkDocument" onAction="#onLinkDocument" styleClass="button-success" />
          </HBox>

          <ListView fx:id="lstLinkedDocuments" prefHeight="150">
            <placeholder>
              <Label text="No documents linked to this program yet." style="-fx-text-fill: #9e9e9e;" />
            </placeholder>
          </ListView>

          <HBox spacing="12">
            <Button text="Unlink Selected" fx:id="btnUnlinkDocument" onAction="#onUnlinkDocument" styleClass="button-warning" />
            <Button text="Refresh Documents" onAction="#onRefreshDocuments" />
          </HBox>
        </VBox>

      </children>

      <padding>
        <Insets top="20" right="20" bottom="20" left="20" />
      </padding>
    </VBox>
  </content>
</ScrollPane>